# Права пользователей

У нас есть в базе данных разделы

	users
	rights

Rights отвечает за права, но назначает эти права не отдельным пользователями, а группам пользователей.

Если вам нужно назначить права одному конкретному пользователю, нужно создать новую группу специально для него.
Поместить пользователя в эту группу и управлять правами этой группы.

Группу пользователя в его записи определяет ключ 'parents', в т.е. родители.

Пользователь также может состоять в нескольких группах, но лучше этого не делать, т.к. права групп будут смешиваться.
В любом случае права, которые назначены пользователю будут читаться в порядке их назначения или следования.
И будут накладываться друг на друга.

Разберем пример.

Есть два раздела:

	news
	catalog
	
Группы пользователей:

	a - разрешен доступ в раздел 'news'
	b - разрешен доступ в раздел 'catalog'
	c - разрешен доступ в раздел 'news' и запрещен в 'catalog'
	d - разрешен доступ в раздел 'catalog' и запрещен в 'news'

И пользователи:

	user_ab - в группах 'a', 'b'
	user_cd - в группах 'c', 'd'
	user_dc - в группах 'd', 'c'

Теперь посмотрим на их права.

Для пользователя 'user_ab' сначала будут назначены права группы 'a', т.е. ему будет разрешен доступ в раздел 'news'.
Затем к нему будут применены права группы 'b'. В них нет явного запрещения на доступ к разделу 'news', но разрешен доступ в раздел 'catalog'.
В результате работы системы такой пользователь получит доступ к обоим разделам - и 'catalog', и 'news'.

Перейдем к пользователю 'user_cd'. К нему сначала применятся права группы 'c' и только потом права группы 'd'.
Поэтому разрешение на доступ в раздел 'catalog' в группе 'd' заменит запрещение на доступ из предыдущей группы 'c'.
Но для группы 'd' явно запрещен доступ в раздел 'news'. И это запрещение также заменит предыдущее разрешение, которое было дано в группе 'c'.
В итоге, пользователь 'user_cd' будет иметь доступ в раздел 'catalog', а доступ в раздел 'news' будет запрещен.

С пользователем 'user_dc' ситуация ровно обратная, т.к. ему сначала назначается группа 'd', а затем - 'c'.
Он получит доступ в раздел 'news', и не получит в раздел 'catalog'.

Давайте теперь посмотрим, как будут вести себя пользователи с правами одной группы в разных ситуациях.

Например, есть пользователи:

	user_a - в группе 'a'
	user_b - в группе 'b'
	user_ab - в группе 'a', 'b'

И есть два различных варианта конфигурации прав по-умолчанию:

	все права разрешены
	все права запрещены

Для первой конфигурации пользователи будут иметь равные права. Но для второй - разные.
Так, пользователь 'user_a' не получит доступ в раздел 'catalog'. А пользователь 'user_b' - в 'news'.
А вот пользователь 'user_ab' получит доступ в оба этих раздела.

Это позволяет очень гибко управлять правами пользователей. Но требует внимательности.

При таком подходе вы можете оказаться в ситуации, когда даже небольшое изменение прав или конфигурации прав по-умолчанию
будет иметь серьезные последствия.
